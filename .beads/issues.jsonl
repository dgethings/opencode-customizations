{"id":"opencode-customizations-b84","title":"Add tests and evals for youtube-obsidian skill","description":"Add comprehensive tests and evaluation scripts to improve reliability of the youtube-obsidian skill.\n\n## Goal\nAdd 22 tests (21 unit + 1 integration) and an eval script for get_youtube_data.py to ensure skill reliability.\n\n## Scope\n- Create pyproject.toml with dependencies and pytest config\n- Create test_data/ directory with mock data and test cases\n- Create scripts/capture_test_data.py to capture real API data\n- Create scripts/test_get_youtube_data.py with 22 tests\n- Create evals/eval_youtube_obsidian.py for evaluation\n- Update SKILL.md with testing section\n- Create .github/workflows/test.yml for CI/CD\n- Update AGENTS.md with skill-specific commands\n\n## Test Coverage Requirements\n- Minimum 80% code coverage enforced via pytest-cov\n- 21 unit tests (6 for URL parsing, 4 for filename sanitization, 5 for tag generation, 3 for note creation, 3 for metadata, 2 for transcript)\n- 1 integration test using real YouTube API (skipped if YOUTUBE_API_KEY not set)\n- All external API calls mocked using pytest-mock and requests-mock\n\n## CI/CD Requirements\n- GitHub Actions workflow\n- Run unit tests with mocked APIs (no API key required)\n- Run integration tests and evals only if YOUTUBE_API_KEY secret is configured\n- Enforce 80% coverage threshold\n- Run linting (ruff check)\n- Run format checking (ruff format --check)\n\n## Dependencies\n- requests\u003e=2.31.0\n- youtube-transcript-api\u003e=0.6.0\n- pytest\u003e=8.0.0\n- pytest-mock\u003e=3.12.0\n- pytest-cov\u003e=4.0.0\n- requests-mock\u003e=1.12.0\n\n## Test Data\n- Use real data from a public domain/CC-licensed YouTube video ('Python Programming Basics')\n- Store mock_youtube_api_response.json and mock_transcript.json in test_data/\n- Include sample test_cases.json for eval script","acceptance_criteria":"1. All 22 tests pass locally\n2. Test coverage \u003e= 80%\n3. Eval script runs successfully and validates outputs\n4. CI/CD workflow passes with mocked tests\n5. CI/CD workflow passes with integration tests (if YOUTUBE_API_KEY secret configured)\n6. Linting passes (ruff check)\n7. Format check passes (ruff format --check)\n8. SKILL.md updated with testing section\n9. AGENTS.md updated with skill-specific test commands","status":"open","priority":2,"issue_type":"task","owner":"dgethings@me.com","created_at":"2026-01-11T18:44:27.886739+04:00","created_by":"David Gethings","updated_at":"2026-01-11T18:44:27.886739+04:00"}
